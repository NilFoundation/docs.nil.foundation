import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

# Writing a new circuit

This tutorial covers developing a simple circuit and compiling it.

## Meeting the prerequisites

First, install the zkLLVM compiler from a pre-built binary distributed as a Debian package.

```bash
echo 'deb [trusted=yes]  http://deb.nil.foundation/ubuntu/ all main' >>/etc/apt/sources.list
apt update
apt install -y zkllvm
```

To install the Rust compiler from a pre-built binary, run the following commands.

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
curl --proto '=https' --tlsv1.2 -sSf https://cdn.jsdelivr.net/gh/NilFoundation/zkllvm@master/rslang-installer.py | python - --channel nightly
```

Verify the installation.

```bash
clang-zkllvm --version
rustc +zkllvm -V
```

To learn about other means of installing zkLLVM, [**click here**](../../../zkllvm/getting-started/installation#building-from-sources).

## Writing the circuit code

First, create a new `.cpp` (C++) or a new `.rs` (Rust) file. 

:::tip

When using Rust, we recommend initializing a new Cargo crate and writing the circuit code in `./src/main.rs`. This will allow for using `cargo` as a compiler rather than `rustc`.

:::

Copy and paste the following code inside the file.

<Tabs groupId='language'>
  <TabItem value='cpp' label='C++'>

    ```cpp
    [[circuit]] int multiplication_example(
    int a,
    int b) {
      auto c = a*b;
      return c;
    }
    ```

  </TabItem>
  <TabItem value='rust' label='Rust'>

    ```rust
    #[circuit]
    pub fn multiplication_example(a: i32, b: i32) -> i32 {
      let c = a * b;
      c
    }
    ```

  </TabItem>
</Tabs>

## Compiling the circuit

Run the following command to produce circuit IR.

<Tabs groupId='language'>
  <TabItem value='cpp' label='C++'>

    ```bash
    clang-zkllvm -S -emit-llvm -target assigner -O1 -o circuit.ll path/to/circuit.cpp
    ```

  </TabItem>
  <TabItem value='rust' label='Rust'>

    Using `cargo`:

    ```bash
    cargo +zkllvm build --target assigner-unknown-unknown
    ```

    Using `rustc`:

    ```bash
    rustc +zkllvm --target assigner-unknown-unknown --emit=llvm-ir -C opt-level=3 circuit.rs 
    ```

  </TabItem>
</Tabs>

This should produce an `.ll` file with the circuit IR, which can then be transformed into a statement.